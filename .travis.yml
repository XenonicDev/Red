language: cpp

dist: trusty
sudo: required

env:
  global:
    - CODECOV_TOKEN="c57773e7-bd57-474c-be2c-551d66ba421b"

matrix:
  include:
    - os: linux
      compiler: gcc
      env: COMPILER=gcc
      
    - os: linux
      compiler: clang
      env: COMPILER=clang
      
    - os: osx
      osx_image: xcode8.3
      compiler: clang
      env: COMPILER=clang

install:
- |
  if [[ "${TRAVIS_OS_NAME}" == "osx" ]]; then
    which cmake || brew install cmake
  fi

script:
- bash Build.sh Release x64 coverage
- |
  if [[ "${TRAVIS_OS_NAME}" == "linux" -a "${COMPILER}" == "gcc" ]]; then
    gcov Build/*.cpp.gcno
  fi

after_success:
- bash <(curl -s https://codecov.io/bash)

notifications:
  email: false
